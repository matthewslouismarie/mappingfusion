{% extends 'base.html.twig' %}

{% from 'sections/review.html.twig' import review %}

{% block resources %}
<link rel="stylesheet" href="https://unpkg.com/@glidejs/glide@3.6.0/dist/css/glide.core.css">
<script src="https://unpkg.com/@glidejs/glide@3.6.0/dist/glide.js"></script>
{% endblock %}

{% block title %}{{ article.title }}{% endblock %}

{% block body %}
<div class="page-article">
    <article class="std-article">
        {% if article.review.id is not null %}
        <div class="blue">
            <div class="imafraidijustbluemyself">
            </div>
        </div>
        {% endif %}
        <div class="article-cover"{% if article.cover_filename is defined %} style="background-image: url('{{ app.resource(article.cover_filename) }}');"{% endif %}>
            <div class="content">
                <h1 class="title">{{ article.title }}</h1>
            </div>
        </div>

        <div class="main">
            <nav class="nav _sectionpadded">
                <div class="frame -articlenav _padded -a -g">
                    <ul class="list">
                        <li class="item">
                            <a class="link">Présentation</a>
                        </li>
                        <li class="item">
                            <a class="link">Test explicatif</a>
                        </li>
                        <li class="item">
                            <a class="link">Galerie d’images</a>
                        </li>
                        <li class="item">
                            <a class="link">Résumé et notes</a>
                        </li>
                    </ul>
                </div>
                <a href="#" class="std-button -upper -white">
                    <div class="text">
                        <span class="bold">Comment installer un mod</span>
                    </div>
                </a>
                <div class="frame -related _padded -a -g">
                    <h2 class="heading">Tests et articles similaires</h2>
                    <ul class="list">
                        <li class="item">
                            <a class="link" href="#">
                                <img alt="{{ article.title }}" class="image"{% if article.cover_filename is defined %} src="{{ app.resource(article.cover_filename) }}"{% endif %}>
                                {{ article.title }}
                        </li>
                        <li class="item">
                            <a class="std-button -sm -transparent" href="{{ app.router.generateUrl('review_list') }}">Voir plus de tests</a>
                        </li>
                        <li class="item">
                            <a class="std-button -sm -transparent" href="#">Voir plus d’actualité</a>
                        </li>
                    </ul>
                </div>
            </nav>
            {% if article.review.id is not null %}
            <div class="content -review _sectionpadded">
                <div class="_padded -a -g">
                    <dl class="std-metadata">
                        <div class="item">
                            <dt class="term">Jeu :</dt>
                            <dd class="def">{{ article.review.playable.name }}</dd>
                        </div>
                        <div class="item">
                            <dt class="term">Développeur :</dt>
                            <dd class="def">{% for a in authors %}{{ a.name }}{% if not loop.last %}, {% endif %}{% endfor %}</dd>
                        </div>
                        <div class="item">
                            <dt class="term">Date de sortie :</dt>
                            <dd class="def">{{ article.review.playable.release_date_time|date('Y') }}</dd>
                        </div>
                    </dl>
                    <p class="p">{{ article.review.body }}</p>
                    {{ review(app.mk, article.review.playable, article.review) }}
                </div>
            </div>
            {% endif %}

            <div class="content -articlebody _sectionpadded">
                <div class="std-markdown-container _padded -g">
                    {{ app.mk.format(article.body)|raw }}
                </div>
            </div>

            <div class="content">
                <div class="glide -arrows">
                    <div class="controls" data-glide-el="controls">
                        <button class="button -left" data-glide-dir="<"></button>
                    </div>
                    <div class="glide__track" data-glide-el="track">
                        <ul class="glide__slides">
                            <li class="glide__slide">
                                <a class="link" href="{{ app.router.generateUrl('view-article', {id: article.id}) }}"{% if article.cover_filename is defined %} style="background-image: url({{ app.resource(article.cover_filename) }});"{% endif %}>
                                    <div class="text">{{ app.mk.format(article.title)|raw }}</div>
                                </a>
                            </li>
                            <li class="glide__slide">
                                <a class="link" href="{{ app.router.generateUrl('view-article', {id: article.id}) }}"{% if article.cover_filename is defined %} style="background-image: url({{ app.resource(article.cover_filename) }});"{% endif %}>
                                    <div class="text">{{ app.mk.format(article.title)|raw }}</div>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div class="controls" data-glide-el="controls">
                        <button class="button -right" data-glide-dir=">"></button>
                    </div>
                </div>
            </div>

            {% if article.review.id is not null %}
            <div class="content _sectionpadded">ç
            {{ dump(article.review) }}
                {{ review(app.mk, article.review.playable, article.review, '-summary') }}
            </div>
            {% endif %}

            <div class="content _sectionpadded">
                <div class="article-advice _padded -a">
                    <img alt="Le conseil Mapping-Fusion" class="img" src="{{ app.asset('mapping-fusion-advice.svg') }}">
                    <div class="text">
                        <h2 class="heading">Le petit conseil pour les mappeurs de Mapping Fusion</h2>
                        <p class="text">Le level design et l’éclairage étant très réussi, nous vous recommandons de jouer à ce MOD qui reste un très bonne source d’inspiration pour créer vos maps ! (structure, type de textures, mis en lumière etc...)</p>
                    </div>
                </div>
            </div>
        </div>
    </article>

    {% include 'sections/social-medias-all.html.twig' %}

    {% include 'sections/beginners-all.html.twig' %}
</div>
{% endblock %}

{% block scriptInit %}
<script>
    const glide = new Glide('.glide', {gap: 0});
    glide.on('mount.after', function () {
        glide.update();
    });
    glide.mount();
</script>
{% endblock %}
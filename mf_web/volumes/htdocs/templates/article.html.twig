{% extends 'base.html.twig' %}

{% from 'sections/review.html.twig' import review %}

{% block resources %}
<link rel="stylesheet" href="https://unpkg.com/@glidejs/glide@3.6.0/dist/css/glide.core.css">
<script src="https://unpkg.com/@glidejs/glide@3.6.0/dist/glide.js"></script>
{% endblock %}

{% block title %}{{ article.title }}{% endblock %}

{% block body %}
<div class="page-article">
    <div class="std-article">
        {% if article.review is defined %}
        <div class="blue">
            <div class="imafraidijustbluemyself">
            </div>
        </div>
        {% endif %}
        <div class="article-cover" style="background-image: url('{{ app.resource(article.cover_filename) }}');">
            <div class="content">
                <div class="_wrapper">
                    <h1 class="title _text -text-xl">{{ article.title }}</h1>
                </div>
            </div>
        </div>

        <div class="_wrapper -sm _padding -padding-vert-l">
            <div class="main _flex -col _gap -gap-row-xl">
                {% if article.review is defined %}
                <div class="_flex -col _gap -gap-row-s2">
                    <dl class="std-metadata _gap -gap-col-l _text -text-m">
                        <div class="item">
                            <dt class="term">Jeu :</dt>
                            <dd class="def">{{ article.review.playable.name }}</dd>
                        </div>
                        <div class="item">
                            <dt class="term">Développeur :</dt>
                            <dd class="def">{% for a in authors %}{{ a.name }}{% if not loop.last %}, {% endif %}{% endfor %}</dd>
                        </div>
                        <div class="item">
                            <dt class="term">Date de sortie :</dt>
                            <dd class="def">{{ article.review.playable.release_date_time|date('Y') }}</dd>
                        </div>
                    </dl>
                    <p class="_text -text-s">{{ article.review.body }}</p>
                    {{ review(app.mk, article.review.playable, article.review) }}
                </div>
                {% endif %}

                <div class="content -articlebody _sectionpadded">
                    <div class="std-markdown-container _padded -g">
                        {{ app.mk.format(article.body)|raw }}
                    </div>
                </div>

                {# <div class="glide -arrows">
                    <div class="controls" data-glide-el="controls">
                        <button class="button -left" data-glide-dir="<"></button>
                    </div>
                    <div class="glide__track" data-glide-el="track">
                        <ul class="glide__slides">
                            <li class="glide__slide">
                                <a class="link" href="{{ app.router.generateUrl('view-article', {id: article.id}) }}"{% if article.cover_filename is defined %} style="background-image: url({{ app.resource(article.cover_filename) }});"{% endif %}>
                                    <div class="text">{{ app.mk.format(article.title)|raw }}</div>
                                </a>
                            </li>
                            <li class="glide__slide">
                                <a class="link" href="{{ app.router.generateUrl('view-article', {id: article.id}) }}"{% if article.cover_filename is defined %} style="background-image: url({{ app.resource(article.cover_filename) }});"{% endif %}>
                                    <div class="text">{{ app.mk.format(article.title)|raw }}</div>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div class="controls" data-glide-el="controls">
                        <button class="button -right" data-glide-dir=">"></button>
                    </div>
                </div> #}

                {% if article.review is defined %}
                <div class="content _sectionpadded">
                    {{ review(app.mk, article.review.playable, article.review, '-summary') }}
                </div>
                {% endif %}

                <aside class="article-advice _flex _gap -gap-col-s _padding -padding-s">
                    <img alt="Le conseil Mapping-Fusion" class="img" src="{{ app.asset('mapping-fusion-advice.svg') }}">
                    <div class="text _flex -col _gap -gap-row-xs">
                        <h2 class="heading _text -text-l">Le petit conseil pour les mappeurs de Mapping Fusion</h2>
                        <p class="text _text -text-m">Le level design et l’éclairage étant très réussi, nous vous recommandons de jouer à ce MOD qui reste un très bonne source d’inspiration pour créer vos maps ! (structure, type de textures, mis en lumière etc...)</p>
                    </div>
                </aside>
            </div>

            <nav class="nav _gap -gap-row-s">
                <div class="frame -articlenav _padding -padding-s">
                    <ul class="list">
                        <li class="item">
                            <a class="link">Présentation</a>
                        </li>
                        <li class="item">
                            <a class="link">Test explicatif</a>
                        </li>
                        <li class="item">
                            <a class="link">Galerie d’images</a>
                        </li>
                        <li class="item">
                            <a class="link">Résumé et notes</a>
                        </li>
                    </ul>
                </div>

                <a href="#" class="std-button -padded -upper -white">
                    <div class="text">
                        <span class="bold _text -text-m">Comment installer un mod</span>
                    </div>
                </a>

                <div class="frame -related _gap -gap-row-xs _padding -padding-s">
                    <h2 class="heading _text -text-m ">Tests et articles similaires</h2>
                    <ul class="list _gap -gap-col-xs -gap-row-s">
                        <li class="item">
                            <a class="link _gap -gap-row-xxs" href="#">
                                <img alt="{{ article.title }}" class="image"{% if article.cover_filename is defined %} src="{{ app.resource(article.cover_filename) }}"{% endif %}>
                                <div class="_text -text-s">{{ article.title }}</div>
                            </a>
                        </li>
                        <li class="item">
                            <div class="list _gap -gap-row-xxs">
                                <a class="std-button -sm -transparent _padding -padding-xs _text -text-s" href="{{ app.router.generateUrl('review_list') }}">
                                    <span class="text">Voir plus de tests</span>
                                </a>
                                <a class="std-button -sm -transparent _padding -padding-xs _text -text-s" href="#">
                                    <span class="text">Voir + d’actualité</span>
                                </a>
                            </div>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
    </div>

    {% include 'sections/social-medias-all.html.twig' %}

    {% include 'sections/beginners-all.html.twig' %}
</div>
{% endblock %}

{% block scriptInit %}
<script>
    const glide = new Glide('.glide', {gap: 0});
    glide.on('mount.after', function () {
        glide.update();
    });
    glide.mount();
</script>
{% endblock %}